<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Turnos Predicaci√≥n</title>
  <style>
    /* VARIABLES POR DEFECTO: MODO CLARO */
    :root {
      --bg-body: #f0f2f5;
      --bg-screen: #ffffff;
      --bg-card: #f8f9fa;
      --text-main: #1a1a1a;
      --text-gray: #65676b;
      --primary-orange: #f36100;
      --primary-blue: #0056ff;
      --radius: 24px;
      --border-color: #e4e6eb;
      --shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    /* VARIABLES PARA MODO OSCURO */
    body.dark-mode {
      --bg-body: #1e1e1e;
      --bg-screen: #121212;
      --bg-card: #1e1e1e;
      --text-main: #ffffff;
      --text-gray: #a0a0a0;
      --border-color: rgba(255,255,255,0.05);
      --shadow: none;
    }

    * { box-sizing: border-box; transition: background-color 0.3s, color 0.3s; }
    body { margin: 0; font-family: 'Segoe UI', sans-serif; background-color: var(--bg-body); color: var(--text-main); }
    
    .app-wrapper { display: grid; grid-template-columns: 1fr; gap: 20px; width: 100%; max-width: 1100px; padding: 20px; margin: auto; }
    .screen { background-color: var(--bg-screen); border-radius: var(--radius); overflow: hidden; height: 850px; display: flex; flex-direction: column; box-shadow: var(--shadow); border: 1px solid var(--border-color); }
    .scroll-container { padding: 20px; overflow-y: auto; flex-grow: 1; }

    /* HEADER */
    .header-list { display: flex; justify-content: space-between; align-items: center; padding: 30px 25px 10px; }
    .theme-toggle { background: var(--bg-card); border: 1px solid var(--border-color); color: var(--text-main); padding: 8px 12px; border-radius: 12px; cursor: pointer; font-weight: bold; }

    /* LISTA IZQUIERDA */
    .location-card { padding: 20px; border-radius: var(--radius); margin-bottom: 12px; cursor: pointer; background-color: var(--bg-card); display: flex; align-items: center; gap: 15px; border: 2px solid transparent; box-shadow: var(--shadow); }
    .location-card.active { border-color: var(--primary-orange); background-color: var(--bg-screen); }
    .status-dot { width: 12px; height: 12px; border-radius: 50%; }
    .location-card h2 { margin: 0; font-size: 0.95rem; font-weight: 600; }

    /* DETALLE DERECHA */
    .hero-img { height: 220px; background-size: cover; background-position: center; position: relative; }
    .hero-img::after { content: ""; position: absolute; inset: 0; background: linear-gradient(to top, var(--bg-screen) 5%, transparent 60%); }
    .back-btn { position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.6); border: none; color: white; padding: 10px 18px; border-radius: 20px; z-index: 20; display: none; font-weight: bold; }

    .info-section { padding: 25px 35px; }
    .info-section h2 { margin: 0 0 25px 0; font-size: 1.8rem; font-weight: 700; }

    /* TARJETAS CONTACTO ALINEADAS */
    .contact-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 30px; }
    .contact-card { background: var(--bg-card); padding: 18px; border-radius: 20px; border: 1px solid var(--border-color); display: flex; flex-direction: column; justify-content: space-between; min-height: 160px; box-shadow: var(--shadow); }
    .contact-header { display: flex; align-items: flex-start; gap: 12px; flex-grow: 1; }
    .icon-circle { width: 45px; height: 45px; border-radius: 50%; flex-shrink: 0; margin-top: 5px; }
    .contact-text b { display: block; font-size: 0.75rem; color: var(--primary-orange); }
    .contact-text span { font-size: 0.9rem; font-weight: 700; }
    .contact-text p { margin: 2px 0 0; font-size: 0.75rem; color: var(--text-gray); }
    
    .call-btn { width: 100%; border: none; padding: 12px; border-radius: 12px; font-weight: bold; cursor: pointer; text-decoration: none; text-align: center; font-size: 0.85rem; display: flex; align-items: center; justify-content: center; gap: 8px; color: white; margin-top: 15px; }
    .call-btn.orange { background: var(--primary-orange); }
    .call-btn.blue { background: var(--primary-blue); }

    /* PILDORAS DE D√çA */
    .days-row { display: flex; gap: 10px; margin-bottom: 30px; overflow-x: auto; padding-bottom: 5px; }
    .day-btn { flex: 1; min-width: 55px; text-align: center; color: var(--text-gray); cursor: pointer; font-weight: 700; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 999px; background: rgba(128,128,128,0.1); }
    .day-btn.active { background: var(--primary-orange); color: #fff; }
    body.dark-mode .day-btn.active { background: #fff; color: var(--primary-orange); }

    /* TURNOS */
    .slot { padding: 22px; border-radius: var(--radius); margin-bottom: 15px; color: white; }
    .turno-M { background-color: var(--primary-orange); }
    .turno-T { background-color: var(--primary-blue); }
    .turno-TD { background-color: #28a745; } /* Verde para turnos disponibles */
    .slot h4 { margin: 0 0 10px 0; font-size: 1.1rem; }
    .badge { background: rgba(255,255,255,0.2); padding: 6px 16px; border-radius: 12px; font-size: 0.85rem; }

    @media (min-width: 768px) { .app-wrapper { grid-template-columns: 350px 1fr; } #detail-screen { display: flex !important; } }
   @media (max-width: 767px) {
    .app-wrapper { padding: 0; }
    .screen { height: 100vh; border-radius: 0; border: none; }
    
    /* Mostrar lista por defecto en m√≥vil */
    #list-screen { display: flex !important; } 
    
    /* Ocultar detalle por defecto en m√≥vil */
    #detail-screen { display: none; } 
    
    .back-btn { display: block; }
    .contact-grid { grid-template-columns: 1fr; }
    .contact-card { min-height: auto; }
}
  </style>
</head>
<body>

  <div class="app-wrapper">
    <section class="screen" id="list-screen">
      <div class="header-list">
        <h1 style="margin:0;">Locaciones</h1>
        <button class="theme-toggle" onclick="toggleTheme()" id="themeBtn">üåô Oscuro</button>
      </div>
      <div class="scroll-container" id="locationsList"></div>
    </section>

    <section class="screen" id="detail-screen">
      <div class="hero-img" id="heroBanner"><button class="back-btn" onclick="goBack()">‚Üê Volver</button></div>
      <div class="info-section">
        <h2 id="currentPointTitle">Cargando...</h2>
        
        <div class="contact-grid" id="contactSection"></div>

        <div class="days-row">
          <div class="day-btn active" onclick="setDay('Lunes', this)">Lun</div>
          <div class="day-btn" onclick="setDay('Martes', this)">Mar</div>
          <div class="day-btn" onclick="setDay('Miercoles', this)">Mie</div>
          <div class="day-btn" onclick="setDay('Jueves', this)">Jue</div>
          <div class="day-btn" onclick="setDay('Viernes', this)">Vie</div>
          <div class="day-btn" onclick="setDay('Sabado', this)">Sab</div>
          <div class="day-btn" onclick="setDay('Domingo', this)">Dom</div>
        </div>
        <div id="slotsContainer"></div>
      </div>
    </section>
  </div>

 <script>
    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT22dGTCsHGc5Qj4EbMxn4XqPoPuUI93UblvVlwu0nPm4FOUzMvLCIv5eTCgjQXS3MiNamBMsBdJ45A/pub?output=csv';

    const POINT_DATA = {
      "Cl√≠nica Cordillera": {
        img: "https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d?q=80&w=1000",
        color: "#f36100",
        guardado: { lugar: "Punto de guardado del carrito", nombre: "Av. Alejandro Fleming 7806", sub: "Casa de Eliana Whittaker", tel: "+56982195443" },
        encargado: { tit: "Encargado de punto", nombre: "Douglas Garc√≠a", tel: "+56934574675" }
      },
      "Supermercado Lider": {
        img: "https://images.unsplash.com/photo-1534452203293-494d7ddbf7e0?q=80&w=1000",
        color: "#0056ff",
        guardado: { lugar: "Punto de guardado del carrito", nombre: "Av. Alejandro Fleming 7806", sub: "Casa de Eliana Whittaker", tel: "+56982195443" },
        encargado: { tit: "Encargado de punto", nombre: "Douglas Garc√≠a", tel: "+56934574675" }
      },
      "Santa Zita": {
        img: "https://appassets.mvtdev.com/map/41/st/642/2193637.webp",
        color: "#04c92f",
        guardado: { lugar: "Punto de guardado del carrito", nombre: "Incahuasi 1549", sub: "Casa de la Familia Tobar", tel: "+56992357751" },
        encargado: { tit: "Encargado de punto", nombre: "Fernando Aldunate", tel: "+56996377733" }
      },
      "Visviri/Supermercado Santa Isabel": {
        img: "https://images.unsplash.com/photo-1441986300917-64674bd600d8?q=80&w=1000",
        color: "#f36100",
        guardado: { lugar: "Punto de guardado del carrito", nombre: "Espigas 1625", sub: "Casa de la Familia Mu√±oz", tel: "+56987274609" },
        encargado: { tit: "Encargado de punto", nombre: "Fernando Aldunate", tel: "+56996377733" }
      },
      "Feria de Francisco Bilbao (Curaco)": {
        img: "https://images.unsplash.com/photo-1488459711626-9c000639443c?q=80&w=1000",
        color: "#0056ff",
        guardado: { lugar: "Punto de guardado del carrito", nombre: "Duqueco 1965 - Dpto 116 T4", sub: "Departamento de Ingrid Arnold", tel: "+56977081786" },
        encargado: { tit: "Encargado de punto", nombre: "Germ√°n Cabezas", tel: "+56967883164" }
      },
      "Parque Intercomunal": {
        img: "https://images.unsplash.com/photo-1585822310497-99b50e6fd373?q=80&w=1000",
        color: "#04c92f",
        guardado: { lugar: "Punto de guardado del carrito", nombre: "Duqueco 1965 - Dpto 116 T4", sub: "Departamento de Ingrid Arnold", tel: "+56977081786" },
        encargado: { tit: "Encargado de punto", nombre: "Germ√°n Cabezas", tel: "+56967883164" }
      },
      "Patricia": {
        img: "https://images.unsplash.com/photo-1517021897933-0e0319cfbc28?q=80&w=1000",
        color: "#f36100",
        guardado: { lugar: "Punto de guardado del carrito", nombre: "Incahuasi 1549", sub: "Casa de la Familia Tobar", tel: "+56992357751" },
        encargado: { tit: "Encargado de punto", nombre: "Fernando Aldunate", tel: "+56996377733" }
      }
    };

    let allData = [];
    let currentDay = 'Lunes';
    let currentPoint = "Cl√≠nica Cordillera";

    async function init() {
      const listContainer = document.getElementById('locationsList');
      listContainer.innerHTML = '';
      
      Object.keys(POINT_DATA).forEach(name => {
        const card = document.createElement('div');
        card.className = `location-card ${name === currentPoint ? 'active' : ''}`;
        card.onclick = () => selectPoint(name);
        card.innerHTML = `<div class="status-dot" style="background-color: ${POINT_DATA[name].color}"></div><h2>${name}</h2>`;
        listContainer.appendChild(card);
      });
      
      await loadExcelData();
      selectPoint(currentPoint);
    }

    async function loadExcelData() {
      try {
        const res = await fetch(SHEET_URL);
        const text = await res.text();
        const rows = text.split(/\r?\n/).slice(1).filter(row => row.trim() !== "");
        
        allData = rows.map(r => {
          const sep = r.includes(';') ? ';' : ',';
          const c = r.split(sep);
          // Mapeo seg√∫n la imagen: A: D√≠a, C: Participantes, D: Horario, E: Punto
          return { 
            dia: c[0]?.trim(), 
            nombres: c[2]?.trim(), 
            hora: c[3]?.trim(), 
            punto: c[4]?.trim() 
          };
        });
        
        renderShifts();
      } catch (e) { console.error("Error cargando CSV:", e); }
    }

    function selectPoint(name) {
  currentPoint = name;
  const info = POINT_DATA[name];
  if(!info) return;

  // Actualizamos textos e im√°genes
  document.getElementById('currentPointTitle').innerText = name;
  document.getElementById('heroBanner').style.backgroundImage = `url('${info.img}')`;
  
  document.getElementById('contactSection').innerHTML = `
    <div class="contact-card">
      <div class="contact-header">
        <div class="icon-circle" style="background: ${info.color}"></div>
        <div class="contact-text">
          <b>${info.guardado.lugar}</b>
          <span>${info.guardado.nombre}</span>
          <p>${info.guardado.sub}</p>
        </div>
      </div>
      <a href="tel:${info.guardado.tel}" class="call-btn orange">Llamar al Punto</a>
    </div>
    <div class="contact-card">
      <div class="contact-header">
        <div class="icon-circle" style="background: var(--primary-blue)"></div>
        <div class="contact-text">
          <b style="color:var(--primary-blue)">${info.encargado.tit}</b>
          <span>${info.encargado.nombre}</span>
        </div>
      </div>
      <a href="tel:${info.encargado.tel}" class="call-btn blue">Llamar al Encargado</a>
    </div>
  `;

  // Marcamos como activa la tarjeta en la lista
  document.querySelectorAll('.location-card').forEach(c => {
    c.classList.toggle('active', c.querySelector('h2').innerText === name);
  });

  // CONTROL DE PANTALLAS PARA M√ìVIL
  if (window.innerWidth < 768) {
    document.getElementById('list-screen').style.setProperty('display', 'none', 'important');
    document.getElementById('detail-screen').style.setProperty('display', 'flex', 'important');
  }

  renderShifts();
}

    function setDay(day, btn) {
      currentDay = day;
      document.querySelectorAll('.day-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      renderShifts();
    }

    function renderShifts() {
  const cont = document.getElementById('slotsContainer');
  const filtered = allData.filter(r => {
    const puntoMatch = r.punto === currentPoint;
    const diaMatch = r.dia?.toLowerCase().startsWith(currentDay.toLowerCase().substring(0,2));
    return puntoMatch && diaMatch;
  });
  
  if(filtered.length === 0) {
    cont.innerHTML = '<p style="text-align:center; color:gray; margin-top:30px;">No hay turnos para este d√≠a.</p>';
    return;
  }

  cont.innerHTML = filtered.map((s, i) => {
    // L√ìGICA DE COLOR:
    // Si el nombre incluye "Disponible", usamos 'turno-TD'
    // Si no, alterna entre Naranja (M) y Azul (T)
    let claseTurno = "";
    if (s.nombres?.toLowerCase().includes("disponible")) {
      claseTurno = "turno-TD";
    } else {
      claseTurno = (i % 2 === 0) ? "turno-M" : "turno-T";
    }

    return `
      <div class="slot ${claseTurno}">
        <h4>${s.nombres}</h4>
        <span class="badge">${s.hora}</span>
      </div>
    `;
  }).join('');
}

    function goBack() {
      document.getElementById('list-screen').style.display = 'flex';
      document.getElementById('detail-screen').style.display = 'none';
    }

    function toggleTheme() {
      const isDark = document.body.classList.toggle('dark-mode');
      document.getElementById('themeBtn').innerHTML = isDark ? '‚òÄÔ∏è Claro' : 'üåô Oscuro';
    }

    window.onload = init;
</script>
</body>
</html>


