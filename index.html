<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Turnos Predicaci√≥n</title>
  <style>
    :root {
      /* Modo Oscuro (Default) */
      --bg-body: #1e1e1e;
      --bg-screen: #121212;
      --bg-card: #1e1e1e;
      --text-main: #ffffff;
      --text-dim: #a0a0a0;
      --primary-orange: #f36100;
      --primary-blue: #0056ff;
      --radius: 24px;
    }

    body.light-mode {
      --bg-body: #f0f2f5;
      --bg-screen: #ffffff;
      --bg-card: #f8f9fa;
      --text-main: #1a1a1a;
      --text-dim: #65676b;
    }

    * { box-sizing: border-box; transition: 0.3s; }
    body { margin: 0; font-family: 'Segoe UI', sans-serif; background-color: var(--bg-body); color: var(--text-main); }
    
    .app-wrapper { display: grid; grid-template-columns: 1fr; gap: 20px; width: 100%; max-width: 1100px; padding: 20px; margin: auto; }
    .screen { background-color: var(--bg-screen); border-radius: var(--radius); overflow: hidden; height: 850px; display: flex; flex-direction: column; }
    .scroll-container { padding: 20px; overflow-y: auto; flex-grow: 1; }

    /* HEADER */
    .header-list { display: flex; justify-content: space-between; align-items: center; padding: 30px 25px 10px; }
    .theme-toggle { background: var(--bg-card); border: 1px solid #444; color: var(--text-main); padding: 8px 12px; border-radius: 12px; cursor: pointer; }

    /* LISTA IZQUIERDA */
    .location-card { padding: 20px; border-radius: var(--radius); margin-bottom: 12px; cursor: pointer; background-color: var(--bg-card); display: flex; align-items: center; gap: 15px; }
    .location-card.active { border: 2px solid var(--primary-orange); }
    .status-dot { width: 12px; height: 12px; border-radius: 50%; }

    /* DETALLE DERECHA */
    .hero-img { height: 220px; background-size: cover; background-position: center; position: relative; }
    .hero-img::after { content: ""; position: absolute; inset: 0; background: linear-gradient(to top, var(--bg-screen) 5%, transparent 60%); }
    .back-btn { position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.6); border: none; color: white; padding: 10px 18px; border-radius: 20px; z-index: 20; display: none; }

    .info-section { padding: 25px; }
    .info-section h2 { margin: 0 0 20px 0; font-size: 1.8rem; }

    /* NUEVAS TARJETAS (Imagen 3) */
    .contact-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px; }
    .contact-card { background: var(--bg-card); padding: 18px; border-radius: 20px; display: flex; flex-direction: column; gap: 12px; border: 1px solid rgba(255,255,255,0.05); }
    .contact-header { display: flex; align-items: center; gap: 12px; }
    .icon-circle { width: 45px; height: 45px; border-radius: 50%; flex-shrink: 0; }
    .contact-text b { display: block; font-size: 0.75rem; color: var(--primary-orange); margin-bottom: 2px; }
    .contact-text.blue b { color: var(--primary-blue); }
    .contact-text span { font-size: 0.9rem; font-weight: 600; line-height: 1.2; }
    .contact-text p { margin: 4px 0 0; font-size: 0.75rem; color: var(--text-dim); }
    
    .call-btn { width: 100%; border: none; padding: 10px; border-radius: 12px; font-weight: bold; cursor: pointer; text-decoration: none; text-align: center; font-size: 0.85rem; display: flex; align-items: center; justify-content: center; gap: 8px; color: white; }
    .call-btn.orange { background: var(--primary-orange); }
    .call-btn.blue { background: var(--primary-blue); }

    /* DIAS Y TURNOS */
    .days-row { display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; }
    .day-btn { padding: 10px 18px; color: var(--text-dim); cursor: pointer; font-weight: 700; border-radius: 15px; background: rgba(128,128,128,0.1); }
    .day-btn.active { background: var(--primary-orange); color: white; }
    
    .slot { padding: 22px; border-radius: var(--radius); margin-bottom: 15px; color: white; }
    .turno-M { background-color: var(--primary-orange); }
    .turno-T { background-color: var(--primary-blue); }

    @media (min-width: 768px) { .app-wrapper { grid-template-columns: 350px 1fr; } #detail-screen { display: flex !important; } }
    @media (max-width: 767px) { .app-wrapper { padding: 0; } .screen { height: 100vh; border-radius: 0; } #detail-screen { display: none; } .back-btn { display: block; } .contact-grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>

  <div class="app-wrapper">
    <section class="screen" id="list-screen">
      <div class="header-list">
        <h1 style="margin:0;">Locaciones</h1>
        <button class="theme-toggle" onclick="toggleTheme()" id="themeBtn">üåô Modo</button>
      </div>
      <div class="scroll-container" id="locationsList"></div>
    </section>

    <section class="screen" id="detail-screen">
      <div class="hero-img" id="heroBanner"><button class="back-btn" onclick="goBack()">‚Üê Volver</button></div>
      <div class="info-section">
        <h2 id="currentPointTitle">Cargando...</h2>
        
        <div class="contact-grid" id="contactSection"></div>

        <div class="days-row">
          <div class="day-btn active" onclick="setDay('Lunes', this)">Lun</div>
          <div class="day-btn" onclick="setDay('Martes', this)">Mar</div>
          <div class="day-btn" onclick="setDay('Miercoles', this)">Mie</div>
          <div class="day-btn" onclick="setDay('Jueves', this)">Jue</div>
          <div class="day-btn" onclick="setDay('Viernes', this)">Vie</div>
          <div class="day-btn" onclick="setDay('Sabado', this)">Sab</div>
          <div class="day-btn" onclick="setDay('Domingo', this)">Dom</div>
        </div>
        <div id="slotsContainer"></div>
      </div>
    </section>
  </div>

  <script>
    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT22dGTCsHGc5Qj4EbMxn4XqPoPuUI93UblvVlwu0nPm4FOUzMvLCIv5eTCgjQXS3MiNamBMsBdJ45A/pub?output=csv';

    // INFORMACI√ìN √öNICA POR LOCACI√ìN (Edita los nombres y n√∫meros aqu√≠)
    const POINT_DATA = {
      "Cl√≠nica Cordillera": {
        img: "https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d?q=80&w=1000",
        color: "#f36100",
        guardado: { 
            lugar: "Punto de guardado del carrito", 
            nombre: "Av. Hola 1234", 
            subtitulo: "Casa de Elionor Gutenberg",
            telefono: "+56912345678" 
        },
        encargado: { 
            titulo: "Encargado de punto", 
            nombre: "Dylan Golfton", 
            telefono: "+56987654321" 
        }
      },
      "Supermercado Lider": {
        img: "https://images.unsplash.com/photo-1534452203293-494d7ddbf7e0?q=80&w=1000",
        color: "#0056ff",
        guardado: { 
            lugar: "Punto de guardado del carrito", 
            nombre: "Bodega Central Lider", 
            subtitulo: "Ingreso por estacionamiento",
            telefono: "+56900001111" 
        },
        encargado: { 
            titulo: "Encargado de punto", 
            nombre: "Juan Perez", 
            telefono: "+56922223333" 
        }
      }
      // Puedes agregar el resto de los puntos siguiendo el mismo formato
    };

    let allData = [];
    let currentDay = 'Lunes';
    let currentPoint = "Cl√≠nica Cordillera";

    function toggleTheme() {
      const isLight = document.body.classList.toggle('light-mode');
      document.getElementById('themeBtn').innerHTML = isLight ? '‚òÄÔ∏è Claro' : 'üåô Oscuro';
    }

    async function init() {
      const listContainer = document.getElementById('locationsList');
      Object.keys(POINT_DATA).forEach(name => {
        const card = document.createElement('div');
        card.className = `location-card ${name === currentPoint ? 'active' : ''}`;
        card.onclick = () => selectPoint(name);
        card.innerHTML = `<div class="status-dot" style="background-color: ${POINT_DATA[name].color}"></div><h2>${name}</h2>`;
        listContainer.appendChild(card);
      });
      await loadExcelData();
      selectPoint(currentPoint);
    }

    async function loadExcelData() {
      try {
        const res = await fetch(SHEET_URL);
        const text = await res.text();
        const rows = text.split(/\r?\n/).slice(1);
        allData = rows.map(r => {
          const c = r.split(r.includes(';') ? ';' : ',');
          return { punto: c[0]?.trim(), dia: c[1]?.trim(), hora: c[2]?.trim(), nombres: c[3]?.trim() };
        });
        renderShifts();
      } catch (e) { console.error(e); }
    }

    function selectPoint(name) {
      currentPoint = name;
      const info = POINT_DATA[name];
      document.getElementById('currentPointTitle').innerText = name;
      document.getElementById('heroBanner').style.backgroundImage = `url('${info.img}')`;
      
      // RENDERIZAR TARJETAS DE CONTACTO (Imagen 3)
      document.getElementById('contactSection').innerHTML = `
        <div class="contact-card">
          <div class="contact-header">
            <div class="icon-circle" style="background: ${info.color}"></div>
            <div class="contact-text">
              <b>${info.guardado.lugar}</b>
              <span>${info.guardado.nombre}</span>
              <p>${info.guardado.subtitulo}</p>
            </div>
          </div>
          <a href="tel:${info.guardado.telefono}" class="call-btn orange">üìû Llamar</a>
        </div>
        <div class="contact-card">
          <div class="contact-header">
            <div class="icon-circle" style="background: var(--primary-blue)"></div>
            <div class="contact-text blue">
              <b>${info.encargado.titulo}</b>
              <span>${info.encargado.nombre}</span>
            </div>
          </div>
          <a href="tel:${info.encargado.telefono}" class="call-btn blue">üìû Llamar</a>
        </div>
      `;

      document.querySelectorAll('.location-card').forEach(c => c.classList.toggle('active', c.innerText.includes(name)));
      if (window.innerWidth < 768) {
        document.getElementById('list-screen').style.display = 'none';
        document.getElementById('detail-screen').style.display = 'flex';
      }
      renderShifts();
    }

    function setDay(day, btn) {
      currentDay = day;
      document.querySelectorAll('.day-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      renderShifts();
    }

    function renderShifts() {
      const cont = document.getElementById('slotsContainer');
      const filtered = allData.filter(r => r.punto === currentPoint && r.dia?.toLowerCase().includes(currentDay.toLowerCase().substring(0,2)));
      
      if(filtered.length === 0) {
        cont.innerHTML = '<p style="text-align:center; color:gray; margin-top:30px;">Sin turnos.</p>';
        return;
      }

      cont.innerHTML = filtered.map((s, i) => `
        <div class="slot ${i % 2 === 0 ? 'turno-M' : 'turno-T'}">
          <h4 style="margin:0 0 8px 0;">${s.nombres}</h4>
          <span style="background:rgba(255,255,255,0.2); padding:4px 10px; border-radius:8px; font-size:0.8rem;">${s.hora}</span>
        </div>
      `).join('');
    }

    function goBack() {
      document.getElementById('list-screen').style.display = 'flex';
      document.getElementById('detail-screen').style.display = 'none';
    }

    window.onload = init;
  </script>
</body>
</html>
