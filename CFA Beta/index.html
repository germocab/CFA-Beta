<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Turnos para la Predicaci√≥n P√∫blica</title>
  <link rel="apple-touch-icon" sizes="180x180" href="favicon_io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon_io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon_io/favicon-16x16.png">
<link rel="manifest" href="favicon_io/site.webmanifest">
  <meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="mobile-web-app-capable" content="yes">

  <style>
   :root {
  /* Variables para MODO OSCURO (Default) */
  --bg-dark: #121212;
  --bg-body: #1e1e1e;
  --bg-card: #2c2c3e;
  --text-main: #ffffff;
  --text-gray: #a0a0a0;
  --green: #04c92f;
  --primary-orange: #f36100;
  --radius: 24px;
  --card-shadow: rgba(0, 0, 0, 0.3);
  --item-bg: #222;
}

/* Variables para MODO CLARO */
[data-theme='light'] {
  --bg-dark: #f0f2f5;
  --bg-body: #ffffff;
  --bg-card: #1b5cff;
  --text-main: #1c1e21;
  --text-gray: #65676b;
  --item-bg: #f9f9f9;
  --card-shadow: rgba(0, 0, 0, 0.1);
}

* { box-sizing: border-box; transition: background-color 0.3s ease, color 0.3s ease; }

body {
  margin: 0;
  font-family: 'Segoe UI', sans-serif;
  background-color: var(--bg-body);
  color: var(--text-main);
  display: flex;
  justify-content: center;
  min-height: 100vh;
}

/* Bot√≥n Flotante de Tema */
/* Contenedor para alinear t√≠tulo y bot√≥n */
.header-container {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* Estilo del bot√≥n al lado del t√≠tulo */
.theme-toggle-inline {
  background: var(--bg-card);
  border: 1px solid var(--text-gray);
  color: var(--text-main);
  width: 40px;
  height: 40px;
  border-radius: 12px;
  cursor: pointer;
  font-size: 1.2rem;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.theme-toggle-inline:hover {
  transform: scale(1.05);
  background-color: var(--primary-orange);
  color: white;
  border-color: var(--primary-orange);
}

/* Ajuste fino para las variables de modo claro en el bot√≥n */
[data-theme='light'] {
  --bg-card: rgb(0, 72, 255);
  /* ... tus otras variables ... */
}

.app-wrapper {
  display: grid;
  grid-template-columns: 1fr;
  gap: 20px;
  width: 100%;
  max-width: 1100px;
  padding: 20px;
}

.screen {
  background-color: var(--bg-dark);
  border-radius: var(--radius);
  overflow: hidden;
  height: 850px;
  display: flex;
  flex-direction: column;
  box-shadow: 0 10px 30px var(--card-shadow);
}

.scroll-container { padding: 20px; overflow-y: auto; flex-grow: 1; }

.location-card {
  padding: 20px;
  border-radius: var(--radius);
  margin-bottom: 15px;
  cursor: pointer;
  transition: 0.3s;
  border: 2px solid transparent;
  background-color: var(--item-bg);
  background-size: cover;
  background-position: center;
  position: relative;
  min-height: 100px;
  display: flex;
  align-items: flex-end;
  overflow: hidden; 
}

.location-card::before {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(to top, rgba(0,0,0,0.8), rgba(0,0,0,0.2));
}

.location-card.active { border-color: var(--primary-orange); }

.card-label { position: relative; z-index: 1; color: white; } /* El texto sobre im√°genes siempre blanco */

.card-label h2 { margin: 0; font-size: 1.1rem; }

.hero-img {
  height: 160px;
  background-color: #333;
  background-size: cover;
  background-position: center;
  position: relative;
}

.back-btn {
  position: absolute; top: 15px; left: 15px;
  background: rgba(0,0,0,0.6); border: none; color: white;
  padding: 8px 15px; border-radius: 20px; cursor: pointer;
  display: none; font-weight: bold; align-items: center; gap: 5px;
  z-index: 2;
}

.days-row { display: flex; gap: 10px; margin: 20px 0; overflow-x: auto; padding-bottom: 5px; }

.day-btn {
  flex: 1;
  text-align: center;
  color: var(--text-gray);
  cursor: pointer;
  font-weight: 700;
  min-width: 45px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 999px;
}

.day-btn.active {
  background: var(--primary-orange);
  color: white;
}

.slot { padding: 20px; border-radius: var(--radius); margin-bottom: 12px; }
.turno-M  { background-color: var(--primary-orange) !important; }
.turno-T  { background-color: var(--bg-card) !important; }
.turno-TD { background-color: var(--green) !important; }

.slot h4 { margin: 0 0 10px 0; font-size: 1.05rem; color: white; }
.badge { background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 12px; font-size: 0.8rem; color: white; }

@media (min-width: 768px) {
  .app-wrapper { grid-template-columns: 350px 1fr; }
  #detail-screen { display: flex !important; }
}

@media (max-width: 767px) {
  .app-wrapper { padding: 0; }
  .screen { height: 100vh; border-radius: 0; }
  #detail-screen { display: none; }
  .back-btn { display: flex; }
}

.p-20 { padding: 20px; }

.punto-info-container {
  display: flex;
  gap: 15px;
  margin: 15px 0;
}

.info-card {
  flex: 1;
  background-color: var(--bg-body); /* Se adapta al tema */
  border-radius: 16px;
  padding: 15px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  border: 1px solid rgba(255,255,255,0.05);
}

[data-theme='light'] .info-card {
  background-color: #ffffff;
  border: 1px solid #eee;
}

.info-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  margin-bottom: 10px;
}

.icon-orange { background-color: var(--primary-orange); }
.icon-blue { background-color: #0055ff; }

.info-text strong {
  display: block;
  font-size: 0.8rem;
  color: #F36100; /* Cambiado de naranja a azul */
  margin-bottom: 5px;
  font-weight: 700; /* Un poco m√°s de grosor para que resalte */
}

.card2 {
    color: #0055ff;
    display: block;
  font-size: 0.8rem;
  margin-bottom: 5px;
  font-weight: 700; /* Un poco m√°s de grosor para que resalte */
}

.info-text p {
  margin: 0;
  font-size: 0.9rem;
  font-weight: 600;
}

.info-text .sub-text {
  font-size: 0.75rem;
  color: var(--text-gray);
  font-weight: normal;
}

/* Botones de Llamada */
.btn-call {
  margin-top: 15px;
  text-decoration: none;
  text-align: center;
  padding: 8px;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: bold;
  color: white !important;
  transition: opacity 0.2s;
}

.call-orange { background-color: var(--primary-orange); }
.call-blue { background-color: #0055ff; }

.btn-call:hover { opacity: 0.8; }

/* Responsivo para m√≥viles */
@media (max-width: 600px) {
  .punto-info-container { flex-direction: column; }
}

  </style>
</head>

<body>
  <div class="app-wrapper">

   <section class="screen" id="list-screen">
  <div class="p-20 header-container">
    <h1 style="margin:0">Locaciones</h1>
    <button class="theme-toggle-inline" id="theme-toggle" onclick="toggleTheme()">
      üåô
    </button>
  </div>

      <div class="scroll-container">
        <div class="location-card active" onclick="selectPoint('Cl√≠nica Cordillera', this)">
          <div class="card-label"><h2>Cl√≠nica Cordillera</h2></div>
        </div>

        <div class="location-card" onclick="selectPoint('Supermercado Lider', this)">
          <div class="card-label"><h2>Supermercado Lider</h2></div>
        </div>

        <div class="location-card" onclick="selectPoint('Santa Zita', this)">
          <div class="card-label"><h2>Santa Zita</h2></div>
        </div>

        <div class="location-card" onclick="selectPoint('Visviri/Supermercado Santa Isabel', this)">
          <div class="card-label"><h2>Visviri / Santa Isabel</h2></div>
        </div>

        <div class="location-card" onclick="selectPoint('Feria de Francisco Bilbao (Curaco)', this)">
          <div class="card-label"><h2>Feria de Francisco Bilbao (Curaco)</h2></div>
        </div>

        <div class="location-card" onclick="selectPoint('Parque Intercomunal', this)">
          <div class="card-label"><h2>Parque Intercomunal</h2></div>
        </div>

        <div class="location-card" onclick="selectPoint('Patricia', this)">
          <div class="card-label"><h2>Patricia</h2></div>
        </div>
      </div>
    </section>

    <section class="screen" id="detail-screen">
      <div class="hero-img">
        <button class="back-btn" onclick="goBack()">‚Üê Volver</button>
      </div>

      <div class="p-20">
        <h2 id="currentPointTitle" style="margin:0">Cl√≠nica Cordillera</h2>

<div class="punto-info-container">
  
  <div class="info-card">
    <div class="info-icon icon-orange"></div>
    <div class="info-text">
      <strong>Punto de guardado del carrito</strong>
      <p id="carrito-dir">Cargando direcci√≥n...</p>
      <p id="carrito-dueno" class="sub-text">Cargando due√±o...</p>
    </div>
    <a href="#" id="btn-llamar-carrito" class="btn-call call-orange">Llamar</a>
  </div>

  <div class="info-card">
    <div class="info-icon icon-blue"></div>
    <div class="info-text">
      <h2 class="card2">Encargado de punto</h2>
      <p id="encargado-nombre">Cargando nombre...</p>
    </div>
    <a href="#" id="btn-llamar-encargado" class="btn-call call-blue">Llamar</a>
  </div>

</div>

        <div class="days-row">
          <div class="day-btn active" onclick="setDay('Lunes', this)">Lun</div>
          <div class="day-btn" onclick="setDay('Martes', this)">Mar</div>
          <div class="day-btn" onclick="setDay('Miercoles', this)">Mie</div>
          <div class="day-btn" onclick="setDay('Jueves', this)">Jue</div>
          <div class="day-btn" onclick="setDay('Viernes', this)">Vie</div>
          <div class="day-btn" onclick="setDay('Sabado', this)">Sab</div>
          <div class="day-btn" onclick="setDay('Domingo', this)">Dom</div>
        </div>

        <div id="slotsContainer">Cargando...</div>
      </div>
    </section>

  </div>

<script>
    // 1. CONFIGURACI√ìN DE RUTAS
    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT22dGTCsHGc5Qj4EbMxn4XqPoPuUI93UblvVlwu0nPm4FOUzMvLCIv5eTCgjQXS3MiNamBMsBdJ45A/pub?output=csv';

    // Base de datos de im√°genes (Aseg√∫rate de que los nombres sean EXACTOS a los del HTML)
    const POINT_IMAGES = {
      "Cl√≠nica Cordillera": "https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d?auto=format&fit=crop&q=80&w=1000",
      "Santa Zita": "https://appassets.mvtdev.com/map/41/st/642/2193637.webp",
      "Supermercado Lider": "https://images.unsplash.com/photo-1534452203293-494d7ddbf7e0?auto=format&fit=crop&q=80&w=1000"
    };

    const CONTACTOS_PUNTOS = {
      "Cl√≠nica Cordillera": { dir: "Av. Fleming 1234", dueno: "Casa de Leonor Gutenberg", tel_carrito: "+56912345678", encargado: "Dylan Golfton", tel_encargado: "+56987654321" },
      "Santa Zita": { dir: "Incahuaso 1265", dueno: "Casa de la Familia Tobar", tel_carrito: "+56900000000", encargado: "Fernando Aldunate", tel_encargado: "+56900000000" },
      "Supermercado Lider": { dir: "Av. Las Condes 9000", dueno: "Bodega Sector A", tel_carrito: "+56900000000", encargado: "Nombre", tel_encargado: "+56911111111" }
    };

    let allData = [];
    let currentDay = 'Lunes';
    let currentPoint = 'Cl√≠nica Cordillera';

    // 2. FUNCI√ìN PARA SELECCIONAR PUNTO
    function selectPoint(name, element) {
        console.log("Seleccionando punto:", name);
        currentPoint = name;
        
        // A. Actualizar T√≠tulo
        const titleElem = document.getElementById('currentPointTitle');
        if(titleElem) titleElem.innerText = name;

        // B. ACTUALIZAR IMAGEN (Banner)
        // Buscamos la imagen dentro del contenedor del banner
        const bannerImg = document.querySelector('.location-banner img');
        if(bannerImg) {
            bannerImg.src = POINT_IMAGES[name] || "";
            console.log("Cambiando imagen a:", bannerImg.src);
        } else {
            console.error("No se encontr√≥ el elemento <img> dentro de .location-banner");
        }

        // C. Actualizar Contactos
        const info = CONTACTOS_PUNTOS[name];
        if(info) {
            document.getElementById('carrito-dir').innerText = info.dir;
            document.getElementById('carrito-dueno').innerText = info.dueno;
            document.getElementById('encargado-nombre').innerText = info.encargado;
            document.getElementById('btn-llamar-carrito').href = "tel:" + info.tel_carrito;
            document.getElementById('btn-llamar-encargado').href = "tel:" + info.tel_encargado;
        }

        // D. Visualizaci√≥n de tarjetas
        document.querySelectorAll('.location-card').forEach(c => c.classList.remove('active'));
        if (element) element.classList.add('active');

        renderShifts();
    }

    // 3. CAMBIAR D√çA
    function setDay(day, element) {
        currentDay = day;
        document.querySelectorAll('.day-btn').forEach(btn => btn.classList.remove('active'));
        if (element) element.classList.add('active');
        renderShifts();
    }

    // 4. RENDERIZAR TURNOS
    function renderShifts() {
        const container = document.getElementById('shiftsContainer');
        if (!container) return;

        console.log(`Filtrando para: ${currentPoint} el d√≠a ${currentDay}`);

        const filtered = allData.filter(row => 
            row.punto.toLowerCase().trim() === currentPoint.toLowerCase().trim() && 
            row.dia.toLowerCase().trim() === currentDay.toLowerCase().trim()
        );

        if (filtered.length === 0) {
            container.innerHTML = '<div class="no-shifts">No hay turnos disponibles.</div>';
            return;
        }

        container.innerHTML = filtered.map(shift => `
            <div class="shift-card">
                <div class="shift-time"><strong>${shift.hora}</strong></div>
                <div class="shift-names">${shift.nombres}</div>
            </div>
        `).join('');
    }

    // 5. CARGAR EXCEL
    async function loadExcelData() {
        try {
            const response = await fetch(SHEET_URL);
            const csvText = await response.text();
            
            // Dividir filas y limpiar datos
            const rows = csvText.split(/\r?\n/).slice(1); 
            allData = rows.map(row => {
                // Esta l√≠nea divide por coma, pero ignora comas dentro de comillas
                const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                return {
                    punto: cols[0] ? cols[0].replace(/"/g, '').trim() : "",
                    dia: cols[1] ? cols[1].replace(/"/g, '').trim() : "",
                    hora: cols[2] ? cols[2].replace(/"/g, '').trim() : "",
                    nombres: cols[3] ? cols[3].replace(/"/g, '').trim() : ""
                };
            });

            console.log("Excel cargado. Total filas:", allData.length);
            
            // Auto-seleccionar el primero
            const firstCard = document.querySelector('.location-card');
            if(firstCard) firstCard.click();

        } catch (error) {
            console.error("Error cargando Excel:", error);
        }
    }

    // 6. INICIO
    window.onload = () => {
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
        loadExcelData();
    };

    function toggleTheme() {
        const html = document.documentElement;
        const newTheme = html.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
        html.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
    }
</script>

</body>
</html>